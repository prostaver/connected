{% extends "theme/base.html" %}

{% block title %}
    <title>Jobs</title>
{% endblock %}

{% block content %}
    <div class="job_detail">
        {{ job }}

        <button class="px-6 py-3 bg-blue-600 text-grey-100 rounded shadow" id="btn-apply" onclick="showModal()">
            Apply
        </button>
        <div class="bg-black bg-opacity-50 absolute inset-0 hidden justify-center items-center" id="modal-apply">
            <div class="bg-gray-200 max-w-sm py-1 px-2 rounded shadow-xl">
                <form action="/job_applications/form/" method="post">
                    <input type="hidden" name="form_applicant_id" value="{{ detailed_user.id }}">
                    <input type="hidden" name="form_job_position_id" id="job_position_id" value="{{ job.id }}">
                    <div class="flex justify-between items-center">
                        <h4 class="text-lg font-bold">
                            Would you like to apply for this position?
                        </h4>
                        <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" id="btn-img-close" onclick="closeModal()">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <div class="mt-3 flex justify-end space-x-3">
                        <button class="px-3 py-1 bg-blue-700 hover:bg-blue-500 rounded" id="btn-apply" type="submit">Apply</button>
                        <button class="px-3 py-1 bg-red-800 hover:bg-red-600 rounded" id="btn-cancel" onclick="closeModal()">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        document.addEventListener("DOMContentLoaded", function(event) { 
            //do work
        });

        const modal = document.querySelector("#modal-apply");
        function showModal() {
            modal.classList.remove("hidden");
            modal.classList.add("flex");
        }

        function closeModal() {
            modal.classList.remove("flex");
            modal.classList.add("hidden");
        }

        // async function apply() {
        //     // console.log("Successfully applied!!");
        //     let applicant_id = +document.getElementById("applicant_id").value;
        //     let job_position_id = +document.getElementById("job_position_id").value;

        //     let data = {
        //         applicant_id: applicant_id,
        //         job_position_id: job_position_id,
        //         status: 1
        //     };

        //     console.log(data);
        //     await fetch("/job_applications/", {
        //         method: "POST",
        //         body: JSON.stringify(data)
        //     });
        // }
    </script>
{% endblock scripts %}